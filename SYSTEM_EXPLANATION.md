# ๐ ุดุฑุญ ุดุงูู ููุธุงู QR Code ููุทุงููุงุช

## ๐ฏ ุงูููุฑุฉ ุงูุนุงูุฉ

ุงููุธุงู ูุณูุญ ูุฃุตุญุงุจ ุงููุทุงุนู ุจุฅูุดุงุก ุทุงููุงุชุ ููู ุทุงููุฉ ุชุญุตู ุนูู **ุตูุฑุฉ QR Code ูุฑูุฏุฉ**. ุนูุฏูุง ููุณุญ ุงูุฒุจูู ูุฐู ุงูุตูุฑุฉ ุจูุงุชููุ ูุชู ุชูุฌููู ูุจุงุดุฑุฉ ุฅูู ูุงุฆูุฉ ุงููุทุนู ูููููู ุงูุทูุจ ุจุฏูู ุงูุญุงุฌุฉ ูููุงุฏู.

---

## ๐ ุณูุฑ ุงูุนูููุฉ ุฎุทูุฉ ุจุฎุทูุฉ

### 1๏ธโฃ **ุงููุฏูุฑ ููุดุฆ ุทุงููุฉ ุฌุฏูุฏุฉ**

```javascript
// ุงูุทูุจ
POST /api/admin/tables
Headers: { Authorization: "Bearer TOKEN" }
Body: {
  "tableNumber": "5",
  "capacity": 4,
  "location": "ุงูุทุงุจู ุงูุฃูู"
}
```

**ูุงุฐุง ูุญุฏุซ ุฏุงุฎู ุงูููุฏุ**

#### ุฃ) ูู Controller ([adminController.js:290](controllers/adminController.js:290)):

```javascript
exports.createTable = async (req, res) => {
  const { restaurantId } = req.user;  // ูู ุงูู token
  const { tableNumber, capacity, location } = req.body;

  // ุงูุฎุทูุฉ 1: ุชูููุฏ ุฑูู QR ูุฑูุฏ
  const qrCode = generateQRCode(restaurantId, tableNumber);
  // ุงููุชูุฌุฉ: "QR-1-5-abc12345"

  // ุงูุฎุทูุฉ 2: ุชูููุฏ ุตูุฑุฉ QR ูุญูุธูุง
  const qrCodeImage = await generateQRCodeImage(restaurantId, tableNumber, qrCode);
  // ุงููุชูุฌุฉ: "/qr-codes/table-1-5-1731585390123.png"

  // ุงูุฎุทูุฉ 3: ุญูุธ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
  const table = await Table.create({
    restaurantId,
    tableNumber,
    qrCode,           // "QR-1-5-abc12345"
    qrCodeImage,      // "/qr-codes/table-1-5-1731585390123.png"
    capacity,
    location
  });

  // ุงูุฎุทูุฉ 4: ุฅุฑุฌุงุน ุงููุชูุฌุฉ ูููุฏูุฑ
  res.json({ success: true, data: table });
};
```

#### ุจ) ุฏุงุฎู ุฏุงูุฉ generateQRCode ([utils/generateNumbers.js:27](utils/generateNumbers.js:27)):

```javascript
exports.generateQRCode = (restaurantId, tableNumber) => {
  const uuid = require('uuid');
  // ูุซุงู: restaurantId = 1, tableNumber = "5"
  // ุงููุชูุฌุฉ: "QR-1-5-abc12345"
  return `QR-${restaurantId}-${tableNumber}-${uuid.v4().slice(0, 8)}`;
};
```

**ููุงุฐุง ูุณุชุฎุฏู UUIDุ**
- ูุถูุงู ุฃู ูู QR code ูุฑูุฏ ุชูุงูุงู
- ุญุชู ูู ูุงู ููุงู ูุทุนูุงู ูุฎุชููุงู ูููุง ููุณ ุฑูู ุงูุทุงููุฉ

#### ุฌ) ุฏุงุฎู ุฏุงูุฉ generateQRCodeImage ([utils/generateNumbers.js:33](utils/generateNumbers.js:33)):

```javascript
exports.generateQRCodeImage = async (restaurantId, tableNumber, qrCodeId) => {
  // ุงูุฎุทูุฉ 1: ุฅูุดุงุก ุงูุฑุงุจุท ุงูุฐู ุณููุฌู ุฅููู QR code
  const menuUrl = `${process.env.FRONTEND_URL}/menu/${qrCodeId}`;
  // ูุซุงู: "http://localhost:3000/menu/QR-1-5-abc12345"

  // ุงูุฎุทูุฉ 2: ุชุญุฏูุฏ ุงุณู ููู ุงูุตูุฑุฉ
  const filename = `table-${restaurantId}-${tableNumber}-${Date.now()}.png`;
  // ูุซุงู: "table-1-5-1731585390123.png"

  // ุงูุฎุทูุฉ 3: ุชุญุฏูุฏ ูุณุงุฑ ุงููุฌูุฏ
  const qrDir = path.join(__dirname, '..', 'public', 'qr-codes');
  // ูุซุงู: "C:\Users\LOQ\Desktop\restaurant-ordering-system\public\qr-codes"

  // ุงูุฎุทูุฉ 4: ุฅูุดุงุก ุงููุฌูุฏ ุฅุฐุง ูู ููู ููุฌูุฏุงู
  if (!fs.existsSync(qrDir)) {
    fs.mkdirSync(qrDir, { recursive: true });
  }

  // ุงูุฎุทูุฉ 5: ุชูููุฏ ุตูุฑุฉ QR ูุญูุธูุง
  await QRCode.toFile(filePath, menuUrl, {
    width: 300,      // ุนุฑุถ ุงูุตูุฑุฉ 300 ุจูุณู
    margin: 2,       // ูุณุงูุฉ ุญูู QR code
    color: {
      dark: '#000000',   // ุงูููู ุงูุฃุณูุฏ ููููุงุท
      light: '#FFFFFF'   // ุงูููู ุงูุฃุจูุถ ููุฎูููุฉ
    }
  });

  // ุงูุฎุทูุฉ 6: ุฅุฑุฌุงุน ุงููุณุงุฑ ุงููุณุจู ููุตูุฑุฉ
  return `/qr-codes/${filename}`;
};
```

**ุงูุตูุฑุฉ ุงูุขู ูุญููุธุฉ ูู:**
```
public/qr-codes/table-1-5-1731585390123.png
```

---

### 2๏ธโฃ **ุงููุฏูุฑ ูุญุตู ุนูู ุจูุงูุงุช ุงูุทุงููุฉ**

```javascript
// ุงูุทูุจ
GET /api/admin/tables

// ุงูุฑุฏ
{
  "success": true,
  "count": 1,
  "data": [
    {
      "id": 1,
      "tableNumber": "5",
      "qrCode": "QR-1-5-abc12345",           // ุงูุฑูู ุงููุฑูุฏ
      "qrCodeImage": "/qr-codes/table-1-5-1731585390123.png",  // ูุณุงุฑ ุงูุตูุฑุฉ
      "capacity": 4,
      "location": "ุงูุทุงุจู ุงูุฃูู",
      "status": "available",
      ...
    }
  ]
}
```

**ุงููุฏูุฑ ููููู ุงูุขู:**
- ุนุฑุถ ุตูุฑุฉ QR ูู ููุญุฉ ุงูุชุญูู
- ุทุจุงุนุฉ ุงูุตูุฑุฉ ููุถุนูุง ุนูู ุงูุทุงููุฉ ุงููุนููุฉ

---

### 3๏ธโฃ **ุงููุตูู ุฅูู ุตูุฑุฉ QR**

ุงููุฏูุฑ ุฃู ุฃู ุดุฎุต ููููู ูุชุญ ุงูุตูุฑุฉ ูู ุฎูุงู:

```
http://localhost:5000/qr-codes/table-1-5-1731585390123.png
```

**ููู ูุนูู ูุฐุงุ**

ูู [server.js:26](server.js:26):
```javascript
// ุชูุฏูู ุงููููุงุช ุงูุซุงุจุชุฉ (ุตูุฑ QR)
app.use('/qr-codes', express.static('public/qr-codes'));
```

ูุฐุง ุงูุณุทุฑ ูุฎุจุฑ Express:
- ุนูุฏูุง ูุทูุจ ุฃุญุฏ `/qr-codes/filename.png`
- ุงุจุญุซ ุนู ุงูููู ูู ูุฌูุฏ `public/qr-codes/filename.png`
- ุฃุฑุณูู ูุตูุฑุฉ

---

### 4๏ธโฃ **ุงูุฒุจูู ููุณุญ ุตูุฑุฉ QR**

**ุงูุฎุทูุงุช:**

1. **ุงูุฒุจูู ูุฌูุณ ุนูู ุงูุทุงููุฉ ุฑูู 5**
2. **ูุฑู ูุฑูุฉ ุนูููุง QR Code ูุทุจูุน**
3. **ููุชุญ ูุงููุฑุง ุงููุงุชู ูููุณุญ QR Code**

**ูุงุฐุง ูุญุฏุซุ**

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ุงููุงููุฑุง ุชูุฑุฃ QR Code              โ
โ  ูุชุฌุฏ ุจุฏุงุฎูู ุงูุฑุงุจุท:                โ
โ  http://localhost:3000/menu/        โ
โ  QR-1-5-abc12345                    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
           โ
           โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ุงููุชุตูุญ ููุชุญ ูุฐุง ุงูุฑุงุจุท ุชููุงุฆูุงู   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
           โ
           โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  Frontend ูุณุชูุจู ุงูุทูุจ:             โ
โ  /menu/QR-1-5-abc12345              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
           โ
           โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  Frontend ูุณุชุฎุฑุฌ qrCode ูู URL:    โ
โ  qrCode = "QR-1-5-abc12345"         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
           โ
           โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  Frontend ูุฑุณู ุทูุจ ููู Backend:     โ
โ  POST /api/sessions                 โ
โ  { qrCode: "QR-1-5-abc12345" }      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
           โ
           โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  Backend ูุจุญุซ ุนู ุงูุทุงููุฉ ูููุชุญ      โ
โ  ุฌูุณุฉ ุฌุฏูุฏุฉ ููุฒุจูู                  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
           โ
           โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  Frontend ูุนุฑุถ ูุงุฆูุฉ ุงููุทุนู          โ
โ  ููุฒุจูู                             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐๏ธ **ุงูุจููุฉ ุงููุงููุฉ ูููููุงุช**

```
restaurant-ordering-system/
โ
โโโ public/
โ   โโโ qr-codes/                    # ูุฌูุฏ ุตูุฑ QR
โ       โโโ table-1-1-1731585390123.png
โ       โโโ table-1-2-1731585390456.png
โ       โโโ table-1-5-1731585390789.png
โ
โโโ utils/
โ   โโโ generateNumbers.js           # ุฏูุงู ุชูููุฏ QR
โ       โโโ generateQRCode()         # ุชูููุฏ ุฑูู ูุฑูุฏ
โ       โโโ generateQRCodeImage()    # ุชูููุฏ ุตูุฑุฉ QR
โ
โโโ controllers/
โ   โโโ adminController.js           # Controller ุฅุฏุงุฑุฉ ุงูุทุงููุงุช
โ       โโโ createTable()            # ุฏุงูุฉ ุฅูุดุงุก ุทุงููุฉ
โ
โโโ models/
โ   โโโ Table.js                     # Model ุงูุทุงููุฉ
โ       โโโ qrCode (STRING)          # ุงูุฑูู ุงููุฑูุฏ
โ       โโโ qrCodeImage (STRING)     # ูุณุงุฑ ุงูุตูุฑุฉ
โ
โโโ server.js                        # ููู ุงูุฎุงุฏู ุงูุฑุฆูุณู
    โโโ app.use('/qr-codes', ...)    # Route ููุตูุฑ
```

---

## โ๏ธ **ุงููุชุบูุฑุงุช ูู .env**

```bash
# ุฑุงุจุท Frontend (ููู ุฌุฏุงู!)
FRONTEND_URL=http://localhost:3000

# ุณููุณุชุฎุฏู ูู ุชูููุฏ ุฑุงุจุท QR:
# http://localhost:3000/menu/{qrCode}
```

**ุฅุฐุง ูุงู Frontend ุนูู ุฑุงุจุท ุขุฎุฑ:**
```bash
FRONTEND_URL=https://myrestaurant.com
# ุงููุชูุฌุฉ: https://myrestaurant.com/menu/{qrCode}
```

---

## ๐ง **ุงููุดููุฉ ุงูุชู ุชู ุฅุตูุงุญูุง**

### โ **ุงูููุฏ ุงููุฏูู (ุฎุทูุฑ):**
```javascript
// ูู server.js
await sequelize.sync({ alter: true });
```

**ุงููุดุงูู:**
- `alter: true` ูุนูู "ุนุฏู ุงูุฌุฏุงูู ุชููุงุฆูุงู ูุชุทุงุจู Models"
- ูุฏ ูุญุฐู ุฃุนูุฏุฉ ุฃู ุจูุงูุงุช ุจุฏูู ุชุญุฐูุฑ
- ุฎุทูุฑ ูู ุงูุฅูุชุงุฌ (Production)
- ูุญุฏุซ ูู **ูู ูุฑุฉ** ูุจุฏุฃ ูููุง ุงูุฎุงุฏู

**ูุซุงู ุนูู ุงูุฎุทุฑ:**
```
ูููุชุฑุถ ุฃู ูุฏูู ุนููุฏ "notes" ูู ุฌุฏูู Tables
ุซู ุญุฐูุช ูุฐุง ุงูุนููุฏ ูู Model
ุนูุฏ ุจุฏุก ุงูุฎุงุฏู ูุน alter: true:
โ ุณูุญุฐู ุงูุนููุฏ "notes" ุชููุงุฆูุงู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
โ ุชุถูุน ุฌููุน ุงูุจูุงูุงุช ุงูููุฌูุฏุฉ ููู!
```

### โ **ุงูููุฏ ุงูุฌุฏูุฏ (ุขูู):**
```javascript
// ูู server.js
await sequelize.sync({ alter: false });
```

**ุงูููุงุฆุฏ:**
- `alter: false` ูุนูู "ูุง ุชุนุฏู ุงูุฌุฏุงููุ ููุท ุชุญูู ูู ูุฌูุฏูุง"
- ุขูู ุชูุงูุงู
- ูุง ูุญุฐู ุฃู ูุนุฏู ุฃู ุจูุงูุงุช
- ุงูุทุฑููุฉ ุงูุตุญูุญุฉ ูู ุงูุฅูุชุงุฌ

**ุงูุทุฑููุฉ ุงูุตุญูุญุฉ ูุชุนุฏูู ูุงุนุฏุฉ ุงูุจูุงูุงุช:**
```bash
# ุงุณุชุฎุฏู Migrations ุจุฏูุงู ูู alter: true
npm run migrate
```

---

## ๐ **ูุซุงู ุนููู ูุงูู**

### ุงูุฎุทูุฉ 1: ุชุณุฌูู ุฏุฎูู
```bash
POST http://localhost:5000/api/auth/login
{
  "email": "admin@restaurant.com",
  "password": "admin123"
}

# ุงูุฑุฏ
{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}
```

### ุงูุฎุทูุฉ 2: ุฅูุดุงุก ุทุงููุฉ
```bash
POST http://localhost:5000/api/admin/tables
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
{
  "tableNumber": "5",
  "capacity": 4
}

# ุงูุฑุฏ
{
  "success": true,
  "data": {
    "id": 1,
    "qrCode": "QR-1-5-abc12345",
    "qrCodeImage": "/qr-codes/table-1-5-1731585390123.png",
    ...
  }
}
```

### ุงูุฎุทูุฉ 3: ุนุฑุถ ุตูุฑุฉ QR
```
ุงูุชุญ ุงููุชุตูุญ:
http://localhost:5000/qr-codes/table-1-5-1731585390123.png
```

### ุงูุฎุทูุฉ 4: ุงูุณุญ QR Code ุจุงููุงุชู
```
ุงููุงููุฑุง ุณุชูุฑุฃ: http://localhost:3000/menu/QR-1-5-abc12345
```

---

## ๐จ **ููู ูููู ูููุฏูุฑ ุงุณุชุฎุฏุงู ุงูุตูุฑุฉุ**

### ูู Frontend (React ูุซูุงู):
```jsx
function TableCard({ table }) {
  return (
    <div>
      <h3>ุทุงููุฉ ุฑูู {table.tableNumber}</h3>

      {/* ุนุฑุถ ุตูุฑุฉ QR */}
      <img
        src={`http://localhost:5000${table.qrCodeImage}`}
        alt={`QR Code for Table ${table.tableNumber}`}
        style={{ width: '200px', height: '200px' }}
      />

      {/* ุฒุฑ ููุทุจุงุนุฉ */}
      <button onClick={() => window.print()}>
        ุทุจุงุนุฉ QR Code
      </button>
    </div>
  );
}
```

### ููุทุจุงุนุฉ:
1. ุงููุฏูุฑ ููุชุญ ุตูุญุฉ ุงูุทุงููุงุช
2. ูุถุบุท "ุทุจุงุนุฉ QR Code"
3. ูุทุจุน ุงูุตูุฑุฉ ููุถุนูุง ุนูู ุงูุทุงููุฉ
4. ุงูุฒุจูู ููุณุญ QR Code ูู ุงููุฑูุฉ ุงููุทุจูุนุฉ

---

## ๐ **ุงูุฃูุงู**

### QR Code ูุฑูุฏ ููุง ูููู ุชุฎูููู:
```
QR-1-5-abc12345
     โ โ โ
     โ โ โโ UUID ุนุดูุงุฆู (8 ุฃุญุฑู)
     โ โโโโ ุฑูู ุงูุทุงููุฉ
     โโโโโโ ID ุงููุทุนู
```

### ูุง ูููู ุงุณุชุฎุฏุงู QR Code ูุทุงููุฉ ุฃุฎุฑู:
- ูู QR Code ูุฑุชุจุท ุจุทุงููุฉ ูุนููุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุฅุฐุง ุญุงูู ุฃุญุฏ ุงุณุชุฎุฏุงู QR Code ูุง ูุฌูุฏ ููุ ุณููุดู

---

## ๐ **ููุฎุต ุงูุชุฏูู ุงููุงูู**

```
1. ุงููุฏูุฑ ููุดุฆ ุทุงููุฉ โ ูุชู ุชูููุฏ QR Code ูุฑูุฏ
2. ูุชู ุฅูุดุงุก ุตูุฑุฉ QR ูุญูุธูุง ูู public/qr-codes/
3. ูุชู ุญูุธ ุฑูู QR ููุณุงุฑ ุงูุตูุฑุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
4. ุงููุฏูุฑ ูุทุจุน ุตูุฑุฉ QR ููุถุนูุง ุนูู ุงูุทุงููุฉ
5. ุงูุฒุจูู ููุณุญ QR Code โ ููุชุญ ุฑุงุจุท ุงููุงุฆูุฉ
6. Frontend ูุณุชุฎุฑุฌ QR Code ูู URL
7. Frontend ููุดุฆ ุฌูุณุฉ ุฌุฏูุฏุฉ ููุทุงููุฉ
8. ุงูุฒุจูู ูุจุฏุฃ ุจุงูุทูุจ ูู ุงููุงุฆูุฉ
```

---

## ๐ **ุงูุฎุทูุงุช ุงูุชุงููุฉ (ูุญุชุงุฌ Frontend)**

ูุฌุจ ุนูู Frontend ุฃู ูููุฐ:

1. **ุตูุญุฉ `/menu/:qrCode`**
   ```javascript
   // ูู React Router
   <Route path="/menu/:qrCode" component={MenuPage} />
   ```

2. **ุงุณุชุฎุฑุงุฌ QR Code ูุฅูุดุงุก ุฌูุณุฉ**
   ```javascript
   const MenuPage = () => {
     const { qrCode } = useParams();

     useEffect(() => {
       // ุฅูุดุงุก ุฌูุณุฉ ููุทุงููุฉ
       axios.post('/api/sessions', { qrCode })
         .then(response => {
           const session = response.data;
           // ุญูุธ Session ูู State ุฃู LocalStorage
           // ุนุฑุถ ุงููุงุฆูุฉ
         });
     }, [qrCode]);
   };
   ```

3. **ุนุฑุถ ุตูุฑ QR ูู ููุญุฉ ุงูุชุญูู**
   ```javascript
   {tables.map(table => (
     <img src={`${API_URL}${table.qrCodeImage}`} />
   ))}
   ```
